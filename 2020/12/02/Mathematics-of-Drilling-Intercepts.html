<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>The Mathematics of Drilling Intercepts | nshea_techblog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="The Mathematics of Drilling Intercepts" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="nshea_techblog" />
<meta property="og:description" content="nshea_techblog" />
<link rel="canonical" href="https://nshea3.github.io/blog/2020/12/02/Mathematics-of-Drilling-Intercepts.html" />
<meta property="og:url" content="https://nshea3.github.io/blog/2020/12/02/Mathematics-of-Drilling-Intercepts.html" />
<meta property="og:site_name" content="nshea_techblog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-12-02T00:00:00-06:00" />
<script type="application/ld+json">
{"url":"https://nshea3.github.io/blog/2020/12/02/Mathematics-of-Drilling-Intercepts.html","@type":"BlogPosting","headline":"The Mathematics of Drilling Intercepts","dateModified":"2020-12-02T00:00:00-06:00","datePublished":"2020-12-02T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://nshea3.github.io/blog/2020/12/02/Mathematics-of-Drilling-Intercepts.html"},"description":"nshea_techblog","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://nshea3.github.io/blog/feed.xml" title="nshea_techblog" /><link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">nshea_techblog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About Me</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">The Mathematics of Drilling Intercepts</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-12-02T00:00:00-06:00" itemprop="datePublished">
        Dec 2, 2020
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      16 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/nshea3/blog/tree/master/_notebooks/2020-12-02-Mathematics-of-Drilling-Intercepts.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/nshea3/blog/master?filepath=_notebooks%2F2020-12-02-Mathematics-of-Drilling-Intercepts.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/nshea3/blog/blob/master/_notebooks/2020-12-02-Mathematics-of-Drilling-Intercepts.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Introduction">Introduction </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-12-02-Mathematics-of-Drilling-Intercepts.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Introduction">
<a class="anchor" href="#Introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction<a class="anchor-link" href="#Introduction"> </a>
</h2>
<p>Drilling intercepts are a prominent feature of junior mining news releases. They are closely monitored by the mining investment community, and a particularly good intercept can raise the prospects for a project.</p>
<p>As an example, consider this November 10 2020 release from Freegold Ventures:</p>
<blockquote>
<p><em>Freegold Intercepts 3.78 g/t Au Over 119 Metres Including 131.5 g/t Over 3 Metres Within 573 Metres of 1.21 g/t Au at Golden Summit</em></p>
</blockquote>
<p>The market responded with a 3% boost in the share price the next trading day, so clearly this was regarded as a positive signal for the company's prospects. <a href="https://doi.org/10.1177%2F0312896212473401">(This is typical:capital markets tend to treat any news of this sort as good news.)</a>
The implications for the economic, geological, and engineering variables surrounding the project are much less clear. <em>Is this a good geological result? Is it a good engineering result?</em> Intercepts are <em>highlights</em>: incomplete data, collected and released selectively, so is it even possible to make an informed judgement using these numbers?</p>
<p>To complicate things even further, the selectively reported drilling intercepts are usually released in a rather complex manner, which can make it difficult to distinguish between truly good numbers and deceptively good results.  Drilling intercepts are discussed at great length in other sources (here and here and here) but we'll take a mathematical perspective and develop a model that describes nested intercept configurations of arbitrary complexity.</p>
<p>We'll take Great Bear Resources for an extended example. Great Bear Resources is a Canadian junior mining company whose stock gained substantially on announcement of very high grade intercepts at their Dixie project in Ontario. At time of writing, GBR is trading at a $886 million CAD market cap (which is not very bearish at all!)</p>
<!-- TradingView Widget BEGIN -->
<div class="tradingview-widget-container">
  <div class="tradingview-widget-container__widget"></div>
  <div class="tradingview-widget-copyright">
<a href="https://www.tradingview.com/symbols/TSXV-GBR/" rel="noopener" target="_blank"><span class="blue-text">GBR Price Today</span></a> by TradingView</div>
  <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async="">
  {
  "symbol": "TSXV:GBR",
  "width": "100%",
  "colorTheme": "light",
  "isTransparent": false,
  "locale": "en"
}
  </script>
</div>
<!-- TradingView Widget END -->
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we open up the spreadsheet of drilling results (available on their website), and then filter on <code>Drill Hole</code> to consider a single hole:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">intercepts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">'drive/My Drive/Projects/posts/data/Great_Bear/lp_drill_hole_composites_all.xlsx'</span><span class="p">)</span>
<span class="n">intercepts</span><span class="p">[</span><span class="s1">'Record'</span><span class="p">]</span> <span class="o">=</span> <span class="n">intercepts</span><span class="o">.</span><span class="n">index</span>

<span class="n">dh</span> <span class="o">=</span> <span class="n">intercepts</span><span class="p">[</span><span class="n">intercepts</span><span class="p">[</span><span class="s1">'Drill Hole'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'BR-022'</span><span class="p">]</span>

<span class="n">dh</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Drill Hole</th>
      <th>Unnamed: 1</th>
      <th>From (m)</th>
      <th>To (m)</th>
      <th>Width (m)</th>
      <th>Gold (g/t)</th>
      <th>Record</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>95</th>
      <td>BR-022</td>
      <td>including</td>
      <td>110.0</td>
      <td>116.10</td>
      <td>6.10</td>
      <td>2.62</td>
      <td>95</td>
    </tr>
    <tr>
      <th>96</th>
      <td>BR-022</td>
      <td>and including</td>
      <td>111.4</td>
      <td>113.10</td>
      <td>1.70</td>
      <td>7.92</td>
      <td>96</td>
    </tr>
    <tr>
      <th>97</th>
      <td>BR-022</td>
      <td>and</td>
      <td>274.0</td>
      <td>299.00</td>
      <td>25.00</td>
      <td>0.19</td>
      <td>97</td>
    </tr>
    <tr>
      <th>98</th>
      <td>BR-022</td>
      <td>and</td>
      <td>432.9</td>
      <td>439.00</td>
      <td>6.10</td>
      <td>4.05</td>
      <td>98</td>
    </tr>
    <tr>
      <th>99</th>
      <td>BR-022</td>
      <td>including</td>
      <td>432.9</td>
      <td>435.70</td>
      <td>2.80</td>
      <td>8.18</td>
      <td>99</td>
    </tr>
    <tr>
      <th>100</th>
      <td>BR-022</td>
      <td>and</td>
      <td>445.0</td>
      <td>452.00</td>
      <td>7.00</td>
      <td>0.41</td>
      <td>100</td>
    </tr>
    <tr>
      <th>101</th>
      <td>BR-022</td>
      <td>and</td>
      <td>461.6</td>
      <td>512.00</td>
      <td>50.40</td>
      <td>1.78</td>
      <td>101</td>
    </tr>
    <tr>
      <th>102</th>
      <td>BR-022</td>
      <td>including</td>
      <td>471.0</td>
      <td>512.00</td>
      <td>41.00</td>
      <td>2.09</td>
      <td>102</td>
    </tr>
    <tr>
      <th>103</th>
      <td>BR-022</td>
      <td>and including</td>
      <td>471.0</td>
      <td>478.00</td>
      <td>7.00</td>
      <td>2.37</td>
      <td>103</td>
    </tr>
    <tr>
      <th>104</th>
      <td>BR-022</td>
      <td>and including</td>
      <td>490.0</td>
      <td>491.00</td>
      <td>1.00</td>
      <td>8.15</td>
      <td>104</td>
    </tr>
    <tr>
      <th>105</th>
      <td>BR-022</td>
      <td>and including</td>
      <td>505.2</td>
      <td>508.75</td>
      <td>3.55</td>
      <td>14.90</td>
      <td>105</td>
    </tr>
    <tr>
      <th>106</th>
      <td>BR-022</td>
      <td>and including</td>
      <td>506.2</td>
      <td>506.70</td>
      <td>0.50</td>
      <td>100.48</td>
      <td>106</td>
    </tr>
    <tr>
      <th>107</th>
      <td>BR-022</td>
      <td>and</td>
      <td>600.0</td>
      <td>620.00</td>
      <td>20.00</td>
      <td>0.52</td>
      <td>107</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is how intercepts are typically presented: a table with a <code>From</code> field describing where they started measuring, a <code>To</code> field describing where they stopped, and a <code>Grade</code> field (called <code>Gold</code> here) that tells us how enriched that interval is with the valuable stuff. <code>From</code> and <code>To</code> are typically measured downhole from the drill collar.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's easy to establish a basic understanding of how these tables are read, and many experienced mining investors immediately recognize these grades as very high. The rest of us might need to rely on statistics, since we don't have the benefit of many years' experience with drilling results.</p>
<p>Of course it is first necessary to determine the true assay values for each separate interval from top to bottom. Unfortunately, each row is not independent - some of the intercepts are contained in others, and the subinterval gold is INCLUDED in the parent interval calculation! So we can't just use the <code>Gold (g/t)</code> field directly, since intercepts are reported with these "highlights", or higher grade sections within the longer interval.</p>
<p>Sometimes this convention is used unethically to suggest larger intervals of enrichment than truly exist. This is called "grade smearing" and the method of residual grade calculation applied here will detect any such attempt to disguise poor results.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At first it may seem like the correct interpretation of these intervals is to imagine them intervals stacked on top of one another, but this is very misleading. We can easily visualize this to see the error:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

<div id="altair-viz-361a1f1d786945a4a4400c3f6db4e5c2"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-361a1f1d786945a4a4400c3f6db4e5c2") {
      outputDiv = document.getElementById("altair-viz-361a1f1d786945a4a4400c3f6db4e5c2");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}, "background": "#D9E9F0"}, "data": {"name": "data-70b56d0e4e560e80b77da584878b3f69"}, "mark": "bar", "encoding": {"color": {"type": "quantitative", "field": "Gold (g/t)", "scale": {"scheme": "inferno"}}, "tooltip": [{"type": "quantitative", "field": "Width (m)", "title": "Width"}, {"type": "quantitative", "field": "Gold (g/t)", "title": "Gold Grade"}], "x": {"type": "quantitative", "field": "From (m)", "scale": {"zero": false}}, "x2": {"field": "To (m)"}, "y": {"type": "nominal", "axis": {"domain": false, "offset": 5, "ticks": false, "title": "Intercept ID"}, "field": "Drill Hole"}}, "height": 100, "width": 800, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-70b56d0e4e560e80b77da584878b3f69": [{"Drill Hole": "BR-022", "Unnamed: 1": "including", "From (m)": 110.0, "To (m)": 116.1, "Width (m)": 6.1, "Gold (g/t)": 2.62, "Record": 95}, {"Drill Hole": "BR-022", "Unnamed: 1": "and including", "From (m)": 111.4, "To (m)": 113.1, "Width (m)": 1.7, "Gold (g/t)": 7.92, "Record": 96}, {"Drill Hole": "BR-022", "Unnamed: 1": "and", "From (m)": 274.0, "To (m)": 299.0, "Width (m)": 25.0, "Gold (g/t)": 0.19, "Record": 97}, {"Drill Hole": "BR-022", "Unnamed: 1": "and", "From (m)": 432.9, "To (m)": 439.0, "Width (m)": 6.1, "Gold (g/t)": 4.05, "Record": 98}, {"Drill Hole": "BR-022", "Unnamed: 1": "including", "From (m)": 432.9, "To (m)": 435.7, "Width (m)": 2.8, "Gold (g/t)": 8.18, "Record": 99}, {"Drill Hole": "BR-022", "Unnamed: 1": "and", "From (m)": 445.0, "To (m)": 452.0, "Width (m)": 7.0, "Gold (g/t)": 0.41, "Record": 100}, {"Drill Hole": "BR-022", "Unnamed: 1": "and", "From (m)": 461.6, "To (m)": 512.0, "Width (m)": 50.4, "Gold (g/t)": 1.78, "Record": 101}, {"Drill Hole": "BR-022", "Unnamed: 1": "including", "From (m)": 471.0, "To (m)": 512.0, "Width (m)": 41.0, "Gold (g/t)": 2.09, "Record": 102}, {"Drill Hole": "BR-022", "Unnamed: 1": "and including", "From (m)": 471.0, "To (m)": 478.0, "Width (m)": 7.0, "Gold (g/t)": 2.37, "Record": 103}, {"Drill Hole": "BR-022", "Unnamed: 1": "and including", "From (m)": 490.0, "To (m)": 491.0, "Width (m)": 1.0, "Gold (g/t)": 8.15, "Record": 104}, {"Drill Hole": "BR-022", "Unnamed: 1": "and including", "From (m)": 505.2, "To (m)": 508.75, "Width (m)": 3.55, "Gold (g/t)": 14.9, "Record": 105}, {"Drill Hole": "BR-022", "Unnamed: 1": "and including", "From (m)": 506.2, "To (m)": 506.7, "Width (m)": 0.5, "Gold (g/t)": 100.48, "Record": 106}, {"Drill Hole": "BR-022", "Unnamed: 1": "and", "From (m)": 600.0, "To (m)": 620.0, "Width (m)": 20.0, "Gold (g/t)": 0.52, "Record": 107}]}}, {"mode": "vega-lite"});
</script>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>We only have the total grade, INCLUDING the high-grade, child subintervals. Considering it in that way ignores the fact that the high-grade intervals are included in the wider, lower-grade intervals, inflating the grade measured over that length. This has enormous implications for the <em>continuity</em> of the mineralization, which determines the feasibility of the project. </li>
</ul>
<p>In order to eliminate this effect we'll need to do some math with the intercepts. This visualization attempts to show this hierarchical, branching structure:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

<div id="altair-viz-a6414c22b76d4196b3709511ad6319be"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-a6414c22b76d4196b3709511ad6319be") {
      outputDiv = document.getElementById("altair-viz-a6414c22b76d4196b3709511ad6319be");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}, "background": "#D9E9F0"}, "data": {"name": "data-70b56d0e4e560e80b77da584878b3f69"}, "mark": "bar", "encoding": {"color": {"type": "quantitative", "field": "Gold (g/t)", "scale": {"scheme": "inferno"}}, "tooltip": [{"type": "quantitative", "field": "Width (m)", "title": "Width"}, {"type": "quantitative", "field": "Gold (g/t)", "title": "Gold Grade"}], "x": {"type": "quantitative", "field": "From (m)", "scale": {"zero": false}}, "x2": {"field": "To (m)"}, "y": {"type": "nominal", "axis": {"domain": false, "offset": 5, "ticks": false, "title": "Interval ID"}, "field": "Record"}}, "height": 400, "width": 800, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-70b56d0e4e560e80b77da584878b3f69": [{"Drill Hole": "BR-022", "Unnamed: 1": "including", "From (m)": 110.0, "To (m)": 116.1, "Width (m)": 6.1, "Gold (g/t)": 2.62, "Record": 95}, {"Drill Hole": "BR-022", "Unnamed: 1": "and including", "From (m)": 111.4, "To (m)": 113.1, "Width (m)": 1.7, "Gold (g/t)": 7.92, "Record": 96}, {"Drill Hole": "BR-022", "Unnamed: 1": "and", "From (m)": 274.0, "To (m)": 299.0, "Width (m)": 25.0, "Gold (g/t)": 0.19, "Record": 97}, {"Drill Hole": "BR-022", "Unnamed: 1": "and", "From (m)": 432.9, "To (m)": 439.0, "Width (m)": 6.1, "Gold (g/t)": 4.05, "Record": 98}, {"Drill Hole": "BR-022", "Unnamed: 1": "including", "From (m)": 432.9, "To (m)": 435.7, "Width (m)": 2.8, "Gold (g/t)": 8.18, "Record": 99}, {"Drill Hole": "BR-022", "Unnamed: 1": "and", "From (m)": 445.0, "To (m)": 452.0, "Width (m)": 7.0, "Gold (g/t)": 0.41, "Record": 100}, {"Drill Hole": "BR-022", "Unnamed: 1": "and", "From (m)": 461.6, "To (m)": 512.0, "Width (m)": 50.4, "Gold (g/t)": 1.78, "Record": 101}, {"Drill Hole": "BR-022", "Unnamed: 1": "including", "From (m)": 471.0, "To (m)": 512.0, "Width (m)": 41.0, "Gold (g/t)": 2.09, "Record": 102}, {"Drill Hole": "BR-022", "Unnamed: 1": "and including", "From (m)": 471.0, "To (m)": 478.0, "Width (m)": 7.0, "Gold (g/t)": 2.37, "Record": 103}, {"Drill Hole": "BR-022", "Unnamed: 1": "and including", "From (m)": 490.0, "To (m)": 491.0, "Width (m)": 1.0, "Gold (g/t)": 8.15, "Record": 104}, {"Drill Hole": "BR-022", "Unnamed: 1": "and including", "From (m)": 505.2, "To (m)": 508.75, "Width (m)": 3.55, "Gold (g/t)": 14.9, "Record": 105}, {"Drill Hole": "BR-022", "Unnamed: 1": "and including", "From (m)": 506.2, "To (m)": 506.7, "Width (m)": 0.5, "Gold (g/t)": 100.48, "Record": 106}, {"Drill Hole": "BR-022", "Unnamed: 1": "and", "From (m)": 600.0, "To (m)": 620.0, "Width (m)": 20.0, "Gold (g/t)": 0.52, "Record": 107}]}}, {"mode": "vega-lite"});
</script>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Plotted side by side, the intercepts show the parent-child overlapping relationship and capture the complexity of the problem.</p>
<p>Parent intervals can have no child intervals, a single child interval, or several child intervals. Child intervals themselves can have no child intervals, a single child interval, or several child intervals. Clearly there is a whole class of related problems we could solve with a general solution to this problem.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So far we have treated the <code>From</code> and <code>To</code> fields in isolation, and we can use a cool feature of Pandas to convert them to intervals:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dh</span><span class="p">[</span><span class="s1">'Interval'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dh</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Interval</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">'From (m)'</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s1">'To (m)'</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">dh</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  """Entry point for launching an IPython kernel.
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So the motivation here was to create <code>Interval</code> objects to use them with the <code>pd.Overlaps</code> function and then model the overlap relationship among the different intervals:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">cross_interval</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">dh</span><span class="o">.</span><span class="n">Interval</span><span class="p">,</span><span class="n">dh</span><span class="o">.</span><span class="n">Interval</span><span class="p">)</span>



<span class="n">overlap_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">overlaps</span><span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">interval</span> <span class="ow">in</span> <span class="n">cross_interval</span><span class="p">])</span>

<span class="n">intersect_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">interval</span> <span class="ow">in</span> <span class="n">cross_interval</span><span class="p">])</span>

<span class="n">ns</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">overlap_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we see the overlaps: if a pixel is white, it means that the interval on the x-axis and the interval on the y-axis overlap.</p>
<p>Overlap is symmetric: so each 'child' overlaps with its parent and vice versa. It should become clear that we are actually interested in the "contains" relationship, which is not symmetric and will help us identify parent intervals and child intervals and start reducing the intervals.</p>
<p>Fortunately this is also supported in Python:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Interval</span>

<span class="n">dh</span><span class="p">[</span><span class="s1">'Interval_obj'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dh</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">Interval</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">'From (m)'</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s1">'To (m)'</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


<span class="n">cross_interval</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">dh</span><span class="o">.</span><span class="n">Interval_obj</span><span class="p">,</span><span class="n">dh</span><span class="o">.</span><span class="n">Interval_obj</span><span class="p">)</span>
<span class="n">contain_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_proper_superset</span><span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">interval</span> <span class="ow">in</span> <span class="n">cross_interval</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:5: SettingWithCopyWarning:


A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy

</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we can pull out a tree</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Of the machine-intelligible formats, a <strong>tree data structure</strong> is clearly the most suited to representing the intervals.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">contain_matrix_sq</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>

  <span class="k">if</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>

    <span class="n">all_str_to_node</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">dh</span><span class="p">[</span><span class="s1">'Record'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">root</span>

  <span class="k">else</span><span class="p">:</span>

    <span class="n">all_str_to_node</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">dh</span><span class="p">[</span><span class="s1">'Record'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">all_str_to_node</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">dh</span><span class="p">[</span><span class="s1">'Record'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">col</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])])]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">RenderTree</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">AsciiStyle</span><span class="p">())</span><span class="o">.</span><span class="n">by_attr</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>DH
|-- 95
|   +-- 96
|-- 97
|-- 98
|   +-- 99
|-- 100
|-- 101
|   +-- 102
|       |-- 103
|       |-- 104
|       +-- 105
|           +-- 106
+-- 107
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we are really getting somewhere- we can actually start looking at the global picture (since we now know which intervals are not "child" intervals)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>These are the direct children. We can go ahead and plot them and have a totally accurate picture of the log:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

<div id="altair-viz-7d6568aa89f14912ba55c20d78a5e12f"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-7d6568aa89f14912ba55c20d78a5e12f") {
      outputDiv = document.getElementById("altair-viz-7d6568aa89f14912ba55c20d78a5e12f");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}, "background": "#D9E9F0"}, "data": {"name": "data-34add9d3459026fe9b045663cebd3770"}, "mark": "bar", "encoding": {"color": {"type": "quantitative", "field": "Gold (g/t)", "scale": {"scheme": "inferno"}}, "tooltip": [{"type": "quantitative", "field": "Width (m)", "title": "Width"}, {"type": "quantitative", "field": "Gold (g/t)", "title": "Gold Grade"}], "x": {"type": "quantitative", "field": "From (m)", "scale": {"zero": false}}, "x2": {"field": "To (m)"}, "y": {"type": "nominal", "axis": {"domain": false, "offset": 5, "ticks": false, "title": "Intercept ID"}, "field": "Drill Hole"}}, "height": 100, "width": 800, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-34add9d3459026fe9b045663cebd3770": [{"From (m)": 110.0, "To (m)": 116.1, "Gold (g/t)": 2.62, "Width (m)": 6.1}, {"From (m)": 274.0, "To (m)": 299.0, "Gold (g/t)": 0.19, "Width (m)": 25.0}, {"From (m)": 432.9, "To (m)": 439.0, "Gold (g/t)": 4.05, "Width (m)": 6.1}, {"From (m)": 445.0, "To (m)": 452.0, "Gold (g/t)": 0.41, "Width (m)": 7.0}, {"From (m)": 461.6, "To (m)": 512.0, "Gold (g/t)": 1.78, "Width (m)": 50.4}, {"From (m)": 600.0, "To (m)": 620.0, "Gold (g/t)": 0.52, "Width (m)": 20.0}]}}, {"mode": "vega-lite"});
</script>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dh_prime</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Drill Hole                 object
Unnamed: 1                 object
From (m)                  float64
To (m)                    float64
Width (m)                 float64
Gold (g/t)                float64
Record                      int64
Interval        interval[float64]
Interval_obj               object
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>While that is correct, it is not complete: we have left out all of the additional information provided by the smaller sub-intervals!</p>
<p>In order to incorporate that we will have to remove them from the parent intervals and determine the residual grade (whatever is left once we pull out the gold contained in the subinterval)</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">((</span><span class="mi">119</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">3.78</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">131.5</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">119</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.47689655172413786</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As an example of this kind of calculation, a simpler set of intervals from a  Freegold Ventures press release:</p>
<blockquote>
<p><em>Freegold Intercepts 3.78 g/t Au Over 119 Metres Including 131.5 g/t Over 3 Metres Within 573 Metres of 1.21 g/t Au at Golden Summit</em></p>
</blockquote>
<p>We know the gold grade over the whole 119 meters, and the gold grade over 3 meters, but what is the gold grade over the $119 - 3 = 116 m$?</p>
<p>The solution is a simple weighted average calculation, like compositing over a drillhole:$\frac{119 \times 3.78-3 \times 131.5}{119-3} = 0.477 g/t$</p>
<p>Credit to <a href="https://twitter.com/BrentCo77759016/status/1326183861722599424">https://twitter.com/BrentCo77759016/status/1326183861722599424</a> and</p>
<p>So now we have to do this, but with every single subinterval until we get the residual grade at every point along the drillhole</p>
<p>Fortunately, the tree data structure we selected has specialized methods that make a traversal very simple.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">levelord_nodes</span> <span class="o">=</span> <span class="p">[(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">LevelOrderIter</span><span class="p">(</span><span class="n">root</span><span class="p">)]</span>

<span class="n">levelord_nodes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[('DH',
  (Node('/DH/95'),
   Node('/DH/97'),
   Node('/DH/98'),
   Node('/DH/100'),
   Node('/DH/101'),
   Node('/DH/107'))),
 ('95', (Node('/DH/95/96'),)),
 ('97', ()),
 ('98', (Node('/DH/98/99'),)),
 ('100', ()),
 ('101', (Node('/DH/101/102'),)),
 ('107', ()),
 ('96', ()),
 ('99', ()),
 ('102',
  (Node('/DH/101/102/103'), Node('/DH/101/102/104'), Node('/DH/101/102/105'))),
 ('103', ()),
 ('104', ()),
 ('105', (Node('/DH/101/102/105/106'),)),
 ('106', ())]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nn_np_loi</span> <span class="o">=</span> <span class="p">[(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">LevelOrderIter</span><span class="p">(</span><span class="n">root</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">all_str_to_node</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{'100': Node('/DH/100'),
 '101': Node('/DH/101'),
 '102': Node('/DH/101/102'),
 '103': Node('/DH/101/102/103'),
 '104': Node('/DH/101/102/104'),
 '105': Node('/DH/101/102/105'),
 '106': Node('/DH/101/102/105/106'),
 '107': Node('/DH/107'),
 '95': Node('/DH/95'),
 '96': Node('/DH/95/96'),
 '97': Node('/DH/97'),
 '98': Node('/DH/98'),
 '99': Node('/DH/98/99')}</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">parent</span> <span class="ow">in</span> <span class="n">nn_np_loi</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">all_str_to_node</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>106
105
Node('/DH/101/102/105/106')
104
103
102
Node('/DH/101/102/103')
Node('/DH/101/102/104')
Node('/DH/101/102/105')
99
96
107
101
Node('/DH/101/102')
100
98
Node('/DH/98/99')
97
95
Node('/DH/95/96')
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dh</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Drill Hole</th>
      <th>Unnamed: 1</th>
      <th>From (m)</th>
      <th>To (m)</th>
      <th>Width (m)</th>
      <th>Gold (g/t)</th>
      <th>Record</th>
      <th>Interval</th>
      <th>Interval_obj</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>95</th>
      <td>BR-022</td>
      <td>including</td>
      <td>110.0</td>
      <td>116.10</td>
      <td>6.10</td>
      <td>2.62</td>
      <td>95</td>
      <td>(110.0, 116.1]</td>
      <td>Interval(110.000000000000, 116.100000000000)</td>
    </tr>
    <tr>
      <th>96</th>
      <td>BR-022</td>
      <td>and including</td>
      <td>111.4</td>
      <td>113.10</td>
      <td>1.70</td>
      <td>7.92</td>
      <td>96</td>
      <td>(111.4, 113.1]</td>
      <td>Interval(111.400000000000, 113.100000000000)</td>
    </tr>
    <tr>
      <th>97</th>
      <td>BR-022</td>
      <td>and</td>
      <td>274.0</td>
      <td>299.00</td>
      <td>25.00</td>
      <td>0.19</td>
      <td>97</td>
      <td>(274.0, 299.0]</td>
      <td>Interval(274.000000000000, 299.000000000000)</td>
    </tr>
    <tr>
      <th>98</th>
      <td>BR-022</td>
      <td>and</td>
      <td>432.9</td>
      <td>439.00</td>
      <td>6.10</td>
      <td>4.05</td>
      <td>98</td>
      <td>(432.9, 439.0]</td>
      <td>Interval(432.900000000000, 439.000000000000)</td>
    </tr>
    <tr>
      <th>99</th>
      <td>BR-022</td>
      <td>including</td>
      <td>432.9</td>
      <td>435.70</td>
      <td>2.80</td>
      <td>8.18</td>
      <td>99</td>
      <td>(432.9, 435.7]</td>
      <td>Interval(432.900000000000, 435.700000000000)</td>
    </tr>
    <tr>
      <th>100</th>
      <td>BR-022</td>
      <td>and</td>
      <td>445.0</td>
      <td>452.00</td>
      <td>7.00</td>
      <td>0.41</td>
      <td>100</td>
      <td>(445.0, 452.0]</td>
      <td>Interval(445.000000000000, 452.000000000000)</td>
    </tr>
    <tr>
      <th>101</th>
      <td>BR-022</td>
      <td>and</td>
      <td>461.6</td>
      <td>512.00</td>
      <td>50.40</td>
      <td>1.78</td>
      <td>101</td>
      <td>(461.6, 512.0]</td>
      <td>Interval(461.600000000000, 512.000000000000)</td>
    </tr>
    <tr>
      <th>102</th>
      <td>BR-022</td>
      <td>including</td>
      <td>471.0</td>
      <td>512.00</td>
      <td>41.00</td>
      <td>2.09</td>
      <td>102</td>
      <td>(471.0, 512.0]</td>
      <td>Interval(471.000000000000, 512.000000000000)</td>
    </tr>
    <tr>
      <th>103</th>
      <td>BR-022</td>
      <td>and including</td>
      <td>471.0</td>
      <td>478.00</td>
      <td>7.00</td>
      <td>2.37</td>
      <td>103</td>
      <td>(471.0, 478.0]</td>
      <td>Interval(471.000000000000, 478.000000000000)</td>
    </tr>
    <tr>
      <th>104</th>
      <td>BR-022</td>
      <td>and including</td>
      <td>490.0</td>
      <td>491.00</td>
      <td>1.00</td>
      <td>8.15</td>
      <td>104</td>
      <td>(490.0, 491.0]</td>
      <td>Interval(490.000000000000, 491.000000000000)</td>
    </tr>
    <tr>
      <th>105</th>
      <td>BR-022</td>
      <td>and including</td>
      <td>505.2</td>
      <td>508.75</td>
      <td>3.55</td>
      <td>14.90</td>
      <td>105</td>
      <td>(505.2, 508.75]</td>
      <td>Interval(505.200000000000, 508.750000000000)</td>
    </tr>
    <tr>
      <th>106</th>
      <td>BR-022</td>
      <td>and including</td>
      <td>506.2</td>
      <td>506.70</td>
      <td>0.50</td>
      <td>100.48</td>
      <td>106</td>
      <td>(506.2, 506.7]</td>
      <td>Interval(506.200000000000, 506.700000000000)</td>
    </tr>
    <tr>
      <th>107</th>
      <td>BR-022</td>
      <td>and</td>
      <td>600.0</td>
      <td>620.00</td>
      <td>20.00</td>
      <td>0.52</td>
      <td>107</td>
      <td>(600.0, 620.0]</td>
      <td>Interval(600.000000000000, 620.000000000000)</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cross_interval</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">dh</span><span class="o">.</span><span class="n">Interval_obj</span><span class="p">,</span><span class="n">dh</span><span class="o">.</span><span class="n">Interval_obj</span><span class="p">)</span>

<span class="n">intersect_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">interval</span> <span class="ow">in</span> <span class="n">cross_interval</span><span class="p">])</span>

<span class="n">intersect_matrix</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([Interval(110.000000000000, 116.100000000000),
       Interval(111.400000000000, 113.100000000000), EmptySet(),
       EmptySet(), EmptySet(), EmptySet(), EmptySet(), EmptySet(),
       EmptySet(), EmptySet(), EmptySet(), EmptySet(), EmptySet(),
       Interval(111.400000000000, 113.100000000000),
       Interval(111.400000000000, 113.100000000000), EmptySet(),
       EmptySet(), EmptySet(), EmptySet(), EmptySet(), EmptySet(),
       EmptySet(), EmptySet(), EmptySet(), EmptySet(), EmptySet(),
       EmptySet(), EmptySet(),
       Interval(274.000000000000, 299.000000000000), EmptySet(),
       EmptySet(), EmptySet(), EmptySet(), EmptySet(), EmptySet(),
       EmptySet(), EmptySet(), EmptySet(), EmptySet(), EmptySet(),
       EmptySet(), EmptySet(),
       Interval(432.900000000000, 439.000000000000),
       Interval(432.900000000000, 435.700000000000), EmptySet(),
       EmptySet(), EmptySet(), EmptySet(), EmptySet(), EmptySet(),
       EmptySet(), EmptySet(), EmptySet(), EmptySet(), EmptySet(),
       Interval(432.900000000000, 435.700000000000),
       Interval(432.900000000000, 435.700000000000), EmptySet(),
       EmptySet(), EmptySet(), EmptySet(), EmptySet(), EmptySet(),
       EmptySet(), EmptySet(), EmptySet(), EmptySet(), EmptySet(),
       EmptySet(), EmptySet(),
       Interval(445.000000000000, 452.000000000000), EmptySet(),
       EmptySet(), EmptySet(), EmptySet(), EmptySet(), EmptySet(),
       EmptySet(), EmptySet(), EmptySet(), EmptySet(), EmptySet(),
       EmptySet(), EmptySet(),
       Interval(461.600000000000, 512.000000000000),
       Interval(471.000000000000, 512.000000000000),
       Interval(471.000000000000, 478.000000000000),
       Interval(490.000000000000, 491.000000000000),
       Interval(505.200000000000, 508.750000000000),
       Interval(506.200000000000, 506.700000000000), EmptySet(),
       EmptySet(), EmptySet(), EmptySet(), EmptySet(), EmptySet(),
       EmptySet(), Interval(471.000000000000, 512.000000000000),
       Interval(471.000000000000, 512.000000000000),
       Interval(471.000000000000, 478.000000000000),
       Interval(490.000000000000, 491.000000000000),
       Interval(505.200000000000, 508.750000000000),
       Interval(506.200000000000, 506.700000000000), EmptySet(),
       EmptySet(), EmptySet(), EmptySet(), EmptySet(), EmptySet(),
       EmptySet(), Interval(471.000000000000, 478.000000000000),
       Interval(471.000000000000, 478.000000000000),
       Interval(471.000000000000, 478.000000000000), EmptySet(),
       EmptySet(), EmptySet(), EmptySet(), EmptySet(), EmptySet(),
       EmptySet(), EmptySet(), EmptySet(), EmptySet(),
       Interval(490.000000000000, 491.000000000000),
       Interval(490.000000000000, 491.000000000000), EmptySet(),
       Interval(490.000000000000, 491.000000000000), EmptySet(),
       EmptySet(), EmptySet(), EmptySet(), EmptySet(), EmptySet(),
       EmptySet(), EmptySet(), EmptySet(),
       Interval(505.200000000000, 508.750000000000),
       Interval(505.200000000000, 508.750000000000), EmptySet(),
       EmptySet(), Interval(505.200000000000, 508.750000000000),
       Interval(506.200000000000, 506.700000000000), EmptySet(),
       EmptySet(), EmptySet(), EmptySet(), EmptySet(), EmptySet(),
       EmptySet(), Interval(506.200000000000, 506.700000000000),
       Interval(506.200000000000, 506.700000000000), EmptySet(),
       EmptySet(), Interval(506.200000000000, 506.700000000000),
       Interval(506.200000000000, 506.700000000000), EmptySet(),
       EmptySet(), EmptySet(), EmptySet(), EmptySet(), EmptySet(),
       EmptySet(), EmptySet(), EmptySet(), EmptySet(), EmptySet(),
       EmptySet(), EmptySet(),
       Interval(600.000000000000, 620.000000000000)], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dh</span><span class="p">[</span><span class="s1">'grade_len'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dh</span><span class="p">[</span><span class="s1">'Gold (g/t)'</span><span class="p">]</span> <span class="o">*</span> <span class="n">dh</span><span class="p">[</span><span class="s1">'Width (m)'</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  """Entry point for launching an IPython kernel.
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dh</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Drill Hole</th>
      <th>Unnamed: 1</th>
      <th>From (m)</th>
      <th>To (m)</th>
      <th>Width (m)</th>
      <th>Gold (g/t)</th>
      <th>Record</th>
      <th>Interval</th>
      <th>Interval_obj</th>
      <th>grade_len</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>95</th>
      <td>BR-022</td>
      <td>including</td>
      <td>110.0</td>
      <td>116.10</td>
      <td>6.10</td>
      <td>2.62</td>
      <td>95</td>
      <td>(110.0, 116.1]</td>
      <td>Interval(110.000000000000, 116.100000000000)</td>
      <td>15.982</td>
    </tr>
    <tr>
      <th>96</th>
      <td>BR-022</td>
      <td>and including</td>
      <td>111.4</td>
      <td>113.10</td>
      <td>1.70</td>
      <td>7.92</td>
      <td>96</td>
      <td>(111.4, 113.1]</td>
      <td>Interval(111.400000000000, 113.100000000000)</td>
      <td>13.464</td>
    </tr>
    <tr>
      <th>97</th>
      <td>BR-022</td>
      <td>and</td>
      <td>274.0</td>
      <td>299.00</td>
      <td>25.00</td>
      <td>0.19</td>
      <td>97</td>
      <td>(274.0, 299.0]</td>
      <td>Interval(274.000000000000, 299.000000000000)</td>
      <td>4.750</td>
    </tr>
    <tr>
      <th>98</th>
      <td>BR-022</td>
      <td>and</td>
      <td>432.9</td>
      <td>439.00</td>
      <td>6.10</td>
      <td>4.05</td>
      <td>98</td>
      <td>(432.9, 439.0]</td>
      <td>Interval(432.900000000000, 439.000000000000)</td>
      <td>24.705</td>
    </tr>
    <tr>
      <th>99</th>
      <td>BR-022</td>
      <td>including</td>
      <td>432.9</td>
      <td>435.70</td>
      <td>2.80</td>
      <td>8.18</td>
      <td>99</td>
      <td>(432.9, 435.7]</td>
      <td>Interval(432.900000000000, 435.700000000000)</td>
      <td>22.904</td>
    </tr>
    <tr>
      <th>100</th>
      <td>BR-022</td>
      <td>and</td>
      <td>445.0</td>
      <td>452.00</td>
      <td>7.00</td>
      <td>0.41</td>
      <td>100</td>
      <td>(445.0, 452.0]</td>
      <td>Interval(445.000000000000, 452.000000000000)</td>
      <td>2.870</td>
    </tr>
    <tr>
      <th>101</th>
      <td>BR-022</td>
      <td>and</td>
      <td>461.6</td>
      <td>512.00</td>
      <td>50.40</td>
      <td>1.78</td>
      <td>101</td>
      <td>(461.6, 512.0]</td>
      <td>Interval(461.600000000000, 512.000000000000)</td>
      <td>89.712</td>
    </tr>
    <tr>
      <th>102</th>
      <td>BR-022</td>
      <td>including</td>
      <td>471.0</td>
      <td>512.00</td>
      <td>41.00</td>
      <td>2.09</td>
      <td>102</td>
      <td>(471.0, 512.0]</td>
      <td>Interval(471.000000000000, 512.000000000000)</td>
      <td>85.690</td>
    </tr>
    <tr>
      <th>103</th>
      <td>BR-022</td>
      <td>and including</td>
      <td>471.0</td>
      <td>478.00</td>
      <td>7.00</td>
      <td>2.37</td>
      <td>103</td>
      <td>(471.0, 478.0]</td>
      <td>Interval(471.000000000000, 478.000000000000)</td>
      <td>16.590</td>
    </tr>
    <tr>
      <th>104</th>
      <td>BR-022</td>
      <td>and including</td>
      <td>490.0</td>
      <td>491.00</td>
      <td>1.00</td>
      <td>8.15</td>
      <td>104</td>
      <td>(490.0, 491.0]</td>
      <td>Interval(490.000000000000, 491.000000000000)</td>
      <td>8.150</td>
    </tr>
    <tr>
      <th>105</th>
      <td>BR-022</td>
      <td>and including</td>
      <td>505.2</td>
      <td>508.75</td>
      <td>3.55</td>
      <td>14.90</td>
      <td>105</td>
      <td>(505.2, 508.75]</td>
      <td>Interval(505.200000000000, 508.750000000000)</td>
      <td>52.895</td>
    </tr>
    <tr>
      <th>106</th>
      <td>BR-022</td>
      <td>and including</td>
      <td>506.2</td>
      <td>506.70</td>
      <td>0.50</td>
      <td>100.48</td>
      <td>106</td>
      <td>(506.2, 506.7]</td>
      <td>Interval(506.200000000000, 506.700000000000)</td>
      <td>50.240</td>
    </tr>
    <tr>
      <th>107</th>
      <td>BR-022</td>
      <td>and</td>
      <td>600.0</td>
      <td>620.00</td>
      <td>20.00</td>
      <td>0.52</td>
      <td>107</td>
      <td>(600.0, 620.0]</td>
      <td>Interval(600.000000000000, 620.000000000000)</td>
      <td>10.400</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Union</span>
<span class="kn">import</span> <span class="nn">functools</span>

<span class="n">resid_grades</span><span class="p">,</span> <span class="n">resid_len</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span> 

<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">levelord_nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>

  <span class="n">parent_interval</span> <span class="o">=</span> <span class="n">dh</span><span class="p">[</span><span class="n">dh</span><span class="p">[</span><span class="s1">'Record'</span><span class="p">]</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
  <span class="n">child_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">child</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
  <span class="n">child_intervals</span> <span class="o">=</span> <span class="p">[</span><span class="n">dh</span><span class="p">[</span><span class="n">dh</span><span class="p">[</span><span class="s1">'Record'</span><span class="p">]</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="n">child</span><span class="p">)]</span> <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">child_names</span><span class="p">]</span>

  <span class="n">new_interval_obj</span> <span class="o">=</span> <span class="n">parent_interval</span><span class="o">.</span><span class="n">Interval_obj</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">Union</span><span class="p">([</span><span class="n">child</span><span class="o">.</span><span class="n">Interval_obj</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">child_intervals</span><span class="p">])</span>

  <span class="n">l_child_int</span> <span class="o">=</span> <span class="n">Union</span><span class="p">([</span><span class="n">intv</span><span class="p">[</span><span class="s1">'Interval_obj'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">intv</span> <span class="ow">in</span> <span class="n">child_intervals</span><span class="p">])</span><span class="o">.</span><span class="n">_measure</span>

  <span class="n">lg_child_int</span> <span class="o">=</span> <span class="p">[</span><span class="n">dh</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">child_name</span><span class="p">)][</span><span class="s1">'grade_len'</span><span class="p">]</span> <span class="k">for</span> <span class="n">child_name</span> <span class="ow">in</span> <span class="n">child_names</span><span class="p">]</span>

  <span class="n">lg_total_int</span> <span class="o">=</span> <span class="n">parent_interval</span><span class="o">.</span><span class="n">grade_len</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

  <span class="n">residual_grade</span> <span class="o">=</span> <span class="p">(</span><span class="n">lg_total_int</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">lg_child_int</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">new_interval_obj</span><span class="o">.</span><span class="n">_measure</span><span class="p">)</span>

  <span class="n">resid_grades</span><span class="p">[</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">residual_grade</span>
  <span class="n">resid_len</span><span class="p">[</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">new_interval_obj</span>

  <span class="nb">print</span><span class="p">(</span><span class="s2">"Interval:"</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

  <span class="nb">print</span><span class="p">(</span><span class="s2">"Length x Grade:"</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">lg_total_int</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">lg_child_int</span><span class="p">))</span>

  <span class="nb">print</span><span class="p">(</span><span class="s2">"Residual Grade:"</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">residual_grade</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Interval:
95
Length x Grade:
2.517999999999999
Residual Grade:
0.572272727272726
Interval:
97
Length x Grade:
4.75
Residual Grade:
0.190000000000000
Interval:
98
Length x Grade:
1.801000000000002
Residual Grade:
0.545757575757574
Interval:
100
Length x Grade:
2.8699999999999997
Residual Grade:
0.410000000000000
Interval:
101
Length x Grade:
4.022000000000006
Residual Grade:
0.427872340425534
Interval:
107
Length x Grade:
10.4
Residual Grade:
0.520000000000000
Interval:
96
Length x Grade:
13.464
Residual Grade:
7.92000000000005
Interval:
99
Length x Grade:
22.903999999999996
Residual Grade:
8.17999999999997
Interval:
102
Length x Grade:
8.055000000000007
Residual Grade:
0.273514431239389
Interval:
103
Length x Grade:
16.59
Residual Grade:
2.37000000000000
Interval:
104
Length x Grade:
8.15
Residual Grade:
8.15000000000000
Interval:
105
Length x Grade:
2.654999999999994
Residual Grade:
0.870491803278683
Interval:
106
Length x Grade:
50.24
Residual Grade:
100.480000000000
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check these solutions: 95 should be easy to validate</p>
<p>includes 96</p>
<p>95 extends from 110.00 m to 116.10 m (l = 6.10 m)</p>
<p>96 is the interval from 111.40 to 113.10 m (l = 1.70 m)</p>
<p>Larger interval</p>
<p>(6.10 m)(2.62 g/t) = (1.7 m)(7.92 g/t) + (4.4 m)(x g/t)</p>
<p>Rearranging terms, we get:</p>
<p>$x = \frac{(6.10 m)(2.62 g/t) - (1.7 m)(7.92 g/t)}{ 4.4 m }$</p>
<p>So the residual grade is 0.5723 g/t, which matches the value found above!</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">((</span><span class="mf">6.10</span> <span class="o">*</span> <span class="mf">2.62</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.7</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">7.92</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.5722727272727269</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">resid_len</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{'100': Interval(445.000000000000, 452.000000000000),
 '101': Interval.Ropen(461.600000000000, 471.000000000000),
 '102': Union(Interval.open(478.000000000000, 490.000000000000), Interval.open(491.000000000000, 505.200000000000), Interval.Lopen(508.750000000000, 512.000000000000)),
 '103': Interval(471.000000000000, 478.000000000000),
 '104': Interval(490.000000000000, 491.000000000000),
 '105': Union(Interval.Ropen(505.200000000000, 506.200000000000), Interval.Lopen(506.700000000000, 508.750000000000)),
 '106': Interval(506.200000000000, 506.700000000000),
 '107': Interval(600.000000000000, 620.000000000000),
 '95': Union(Interval.Ropen(110.000000000000, 111.400000000000), Interval.Lopen(113.100000000000, 116.100000000000)),
 '96': Interval(111.400000000000, 113.100000000000),
 '97': Interval(274.000000000000, 299.000000000000),
 '98': Interval.Lopen(435.700000000000, 439.000000000000),
 '99': Interval(432.900000000000, 435.700000000000)}</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Interval</span><span class="p">(</span><span class="mf">445.000000000000</span><span class="p">,</span> <span class="mf">452.000000000000</span><span class="p">)</span><span class="o">.</span><span class="n">end</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>452.000000000000</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dh</span><span class="p">[</span><span class="s1">'Record'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">resid_len</span><span class="p">)</span>
<span class="n">dh</span><span class="p">[</span><span class="s1">'Record'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">resid_grades</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>95     0.572272727272726
96      7.92000000000005
97     0.190000000000000
98     0.545757575757574
99      8.17999999999997
100    0.410000000000000
101    0.427872340425534
102    0.273514431239389
103     2.37000000000000
104     8.15000000000000
105    0.870491803278683
106     100.480000000000
107    0.520000000000000
Name: Record, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>TODO: Need to split up the non-contiguous segments so that you can actually plot them</p>
<p>Idea: use .args attribute
Problem: This is defined for Interval objects as well and it gets us something we don't want</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dh</span><span class="p">[</span><span class="s1">'Record'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">resid_len</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>95     Union(Interval.Ropen(110.000000000000, 111.400...
96          Interval(111.400000000000, 113.100000000000)
97          Interval(274.000000000000, 299.000000000000)
98     Interval.Lopen(435.700000000000, 439.000000000...
99          Interval(432.900000000000, 435.700000000000)
100         Interval(445.000000000000, 452.000000000000)
101    Interval.Ropen(461.600000000000, 471.000000000...
102    Union(Interval.open(478.000000000000, 490.0000...
103         Interval(471.000000000000, 478.000000000000)
104         Interval(490.000000000000, 491.000000000000)
105    Union(Interval.Ropen(505.200000000000, 506.200...
106         Interval(506.200000000000, 506.700000000000)
107         Interval(600.000000000000, 620.000000000000)
Name: Record, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">args_extended</span><span class="p">(</span><span class="n">interval</span><span class="p">):</span>
  <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span> <span class="o">==</span> <span class="n">Union</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">interval</span><span class="o">.</span><span class="n">args</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">interval</span>

<span class="n">remaining_interval_grade</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'interval'</span> <span class="p">:</span> <span class="n">dh</span><span class="p">[</span><span class="s1">'Record'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">resid_len</span><span class="p">),</span> <span class="s1">'grade'</span> <span class="p">:</span> <span class="n">dh</span><span class="p">[</span><span class="s1">'Record'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">resid_grades</span><span class="p">)})</span>

<span class="n">remaining_interval_grade</span><span class="p">[</span><span class="s1">'split_intervals'</span><span class="p">]</span> <span class="o">=</span> <span class="n">remaining_interval_grade</span><span class="o">.</span><span class="n">interval</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">args_extended</span><span class="p">)</span>

<span class="n">rig_exploded</span> <span class="o">=</span> <span class="n">remaining_interval_grade</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s1">'split_intervals'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rig_exploded</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>interval</th>
      <th>grade</th>
      <th>split_intervals</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>95</th>
      <td>Union(Interval.Ropen(110.000000000000, 111.400...</td>
      <td>0.572272727272726</td>
      <td>Interval.Ropen(110.000000000000, 111.400000000...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Union(Interval.Ropen(110.000000000000, 111.400...</td>
      <td>0.572272727272726</td>
      <td>Interval.Lopen(113.100000000000, 116.100000000...</td>
    </tr>
    <tr>
      <th>96</th>
      <td>Interval(111.400000000000, 113.100000000000)</td>
      <td>7.92000000000005</td>
      <td>Interval(111.400000000000, 113.100000000000)</td>
    </tr>
    <tr>
      <th>97</th>
      <td>Interval(274.000000000000, 299.000000000000)</td>
      <td>0.190000000000000</td>
      <td>Interval(274.000000000000, 299.000000000000)</td>
    </tr>
    <tr>
      <th>98</th>
      <td>Interval.Lopen(435.700000000000, 439.000000000...</td>
      <td>0.545757575757574</td>
      <td>Interval.Lopen(435.700000000000, 439.000000000...</td>
    </tr>
    <tr>
      <th>99</th>
      <td>Interval(432.900000000000, 435.700000000000)</td>
      <td>8.17999999999997</td>
      <td>Interval(432.900000000000, 435.700000000000)</td>
    </tr>
    <tr>
      <th>100</th>
      <td>Interval(445.000000000000, 452.000000000000)</td>
      <td>0.410000000000000</td>
      <td>Interval(445.000000000000, 452.000000000000)</td>
    </tr>
    <tr>
      <th>101</th>
      <td>Interval.Ropen(461.600000000000, 471.000000000...</td>
      <td>0.427872340425534</td>
      <td>Interval.Ropen(461.600000000000, 471.000000000...</td>
    </tr>
    <tr>
      <th>102</th>
      <td>Union(Interval.open(478.000000000000, 490.0000...</td>
      <td>0.273514431239389</td>
      <td>Interval.open(478.000000000000, 490.000000000000)</td>
    </tr>
    <tr>
      <th>102</th>
      <td>Union(Interval.open(478.000000000000, 490.0000...</td>
      <td>0.273514431239389</td>
      <td>Interval.open(491.000000000000, 505.200000000000)</td>
    </tr>
    <tr>
      <th>102</th>
      <td>Union(Interval.open(478.000000000000, 490.0000...</td>
      <td>0.273514431239389</td>
      <td>Interval.Lopen(508.750000000000, 512.000000000...</td>
    </tr>
    <tr>
      <th>103</th>
      <td>Interval(471.000000000000, 478.000000000000)</td>
      <td>2.37000000000000</td>
      <td>Interval(471.000000000000, 478.000000000000)</td>
    </tr>
    <tr>
      <th>104</th>
      <td>Interval(490.000000000000, 491.000000000000)</td>
      <td>8.15000000000000</td>
      <td>Interval(490.000000000000, 491.000000000000)</td>
    </tr>
    <tr>
      <th>105</th>
      <td>Union(Interval.Ropen(505.200000000000, 506.200...</td>
      <td>0.870491803278683</td>
      <td>Interval.Ropen(505.200000000000, 506.200000000...</td>
    </tr>
    <tr>
      <th>105</th>
      <td>Union(Interval.Ropen(505.200000000000, 506.200...</td>
      <td>0.870491803278683</td>
      <td>Interval.Lopen(506.700000000000, 508.750000000...</td>
    </tr>
    <tr>
      <th>106</th>
      <td>Interval(506.200000000000, 506.700000000000)</td>
      <td>100.480000000000</td>
      <td>Interval(506.200000000000, 506.700000000000)</td>
    </tr>
    <tr>
      <th>107</th>
      <td>Interval(600.000000000000, 620.000000000000)</td>
      <td>0.520000000000000</td>
      <td>Interval(600.000000000000, 620.000000000000)</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rig_exploded</span><span class="p">[</span><span class="s1">'From'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rig_exploded</span><span class="o">.</span><span class="n">split_intervals</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">start</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">rig_exploded</span><span class="p">[</span><span class="s1">'To'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rig_exploded</span><span class="o">.</span><span class="n">split_intervals</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">end</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">rig_exploded</span><span class="p">[</span><span class="s1">'Width'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">rig_exploded</span><span class="o">.</span><span class="n">To</span> <span class="o">-</span> <span class="n">rig_exploded</span><span class="o">.</span><span class="n">From</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

<span class="n">rig_exploded</span><span class="p">[</span><span class="s1">'grade'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rig_exploded</span><span class="o">.</span><span class="n">grade</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

<span class="n">rig_exploded</span><span class="p">[</span><span class="s1">'drillhole'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'BR-022'</span>	
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rig_exploded</span><span class="p">[[</span><span class="s1">'From'</span><span class="p">,</span> <span class="s1">'To'</span><span class="p">,</span> <span class="s1">'grade'</span><span class="p">,</span> <span class="s1">'Width'</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>From</th>
      <th>To</th>
      <th>grade</th>
      <th>Width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>95</th>
      <td>110.00</td>
      <td>111.40</td>
      <td>0.572273</td>
      <td>1.40</td>
    </tr>
    <tr>
      <th>95</th>
      <td>113.10</td>
      <td>116.10</td>
      <td>0.572273</td>
      <td>3.00</td>
    </tr>
    <tr>
      <th>96</th>
      <td>111.40</td>
      <td>113.10</td>
      <td>7.920000</td>
      <td>1.70</td>
    </tr>
    <tr>
      <th>97</th>
      <td>274.00</td>
      <td>299.00</td>
      <td>0.190000</td>
      <td>25.00</td>
    </tr>
    <tr>
      <th>98</th>
      <td>435.70</td>
      <td>439.00</td>
      <td>0.545758</td>
      <td>3.30</td>
    </tr>
    <tr>
      <th>99</th>
      <td>432.90</td>
      <td>435.70</td>
      <td>8.180000</td>
      <td>2.80</td>
    </tr>
    <tr>
      <th>100</th>
      <td>445.00</td>
      <td>452.00</td>
      <td>0.410000</td>
      <td>7.00</td>
    </tr>
    <tr>
      <th>101</th>
      <td>461.60</td>
      <td>471.00</td>
      <td>0.427872</td>
      <td>9.40</td>
    </tr>
    <tr>
      <th>102</th>
      <td>478.00</td>
      <td>490.00</td>
      <td>0.273514</td>
      <td>12.00</td>
    </tr>
    <tr>
      <th>102</th>
      <td>491.00</td>
      <td>505.20</td>
      <td>0.273514</td>
      <td>14.20</td>
    </tr>
    <tr>
      <th>102</th>
      <td>508.75</td>
      <td>512.00</td>
      <td>0.273514</td>
      <td>3.25</td>
    </tr>
    <tr>
      <th>103</th>
      <td>471.00</td>
      <td>478.00</td>
      <td>2.370000</td>
      <td>7.00</td>
    </tr>
    <tr>
      <th>104</th>
      <td>490.00</td>
      <td>491.00</td>
      <td>8.150000</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>105</th>
      <td>505.20</td>
      <td>506.20</td>
      <td>0.870492</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>105</th>
      <td>506.70</td>
      <td>508.75</td>
      <td>0.870492</td>
      <td>2.05</td>
    </tr>
    <tr>
      <th>106</th>
      <td>506.20</td>
      <td>506.70</td>
      <td>100.480000</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th>107</th>
      <td>600.00</td>
      <td>620.00</td>
      <td>0.520000</td>
      <td>20.00</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">'Intercept ID'</span><span class="p">,</span>
    <span class="n">offset</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">ticks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">domain</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>


<span class="n">reqd_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'From'</span><span class="p">,</span> <span class="s1">'To'</span><span class="p">,</span> <span class="s1">'grade'</span><span class="p">,</span> <span class="s1">'Width'</span><span class="p">,</span> <span class="s1">'drillhole'</span><span class="p">]</span>


<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">rig_exploded</span><span class="p">[</span><span class="n">reqd_cols</span><span class="p">])</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'From:Q'</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
    <span class="n">x2</span><span class="o">=</span><span class="s1">'To:Q'</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'drillhole:N'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">y_axis</span><span class="p">),</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s1">'grade:Q'</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s2">"inferno"</span><span class="p">)),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s1">'Width:Q'</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">'Width'</span><span class="p">),</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s1">'grade:Q'</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">'Gold Grade'</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">background</span><span class="o">=</span><span class="s1">'#D9E9F0'</span><span class="p">)</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

<div id="altair-viz-2b8991bba7d04b1a868cd453a4cd56aa"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-2b8991bba7d04b1a868cd453a4cd56aa") {
      outputDiv = document.getElementById("altair-viz-2b8991bba7d04b1a868cd453a4cd56aa");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}, "background": "#D9E9F0"}, "data": {"name": "data-71d144e1a579f65593490446b05a8639"}, "mark": "bar", "encoding": {"color": {"type": "quantitative", "field": "grade", "scale": {"scheme": "inferno"}}, "tooltip": [{"type": "quantitative", "field": "Width", "title": "Width"}, {"type": "quantitative", "field": "grade", "title": "Gold Grade"}], "x": {"type": "quantitative", "field": "From", "scale": {"zero": false}}, "x2": {"field": "To"}, "y": {"type": "nominal", "axis": {"domain": false, "offset": 5, "ticks": false, "title": "Intercept ID"}, "field": "drillhole"}}, "height": 100, "selection": {"selector002": {"type": "interval", "bind": "scales", "encodings": ["x", "y"]}}, "width": 800, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-71d144e1a579f65593490446b05a8639": [{"From": 110.0, "To": 111.4, "grade": 0.5722727272727263, "Width": 1.4000000000000057, "drillhole": "BR-022"}, {"From": 113.1, "To": 116.1, "grade": 0.5722727272727263, "Width": 3.0, "drillhole": "BR-022"}, {"From": 111.4, "To": 113.1, "grade": 7.920000000000053, "Width": 1.6999999999999886, "drillhole": "BR-022"}, {"From": 274.0, "To": 299.0, "grade": 0.19, "Width": 25.0, "drillhole": "BR-022"}, {"From": 435.7, "To": 439.0, "grade": 0.5457575757575744, "Width": 3.3000000000000114, "drillhole": "BR-022"}, {"From": 432.9, "To": 435.7, "grade": 8.179999999999966, "Width": 2.8000000000000114, "drillhole": "BR-022"}, {"From": 445.0, "To": 452.0, "grade": 0.4099999999999999, "Width": 7.0, "drillhole": "BR-022"}, {"From": 461.6, "To": 471.0, "grade": 0.4278723404255335, "Width": 9.399999999999977, "drillhole": "BR-022"}, {"From": 478.0, "To": 490.0, "grade": 0.2735144312393891, "Width": 12.0, "drillhole": "BR-022"}, {"From": 491.0, "To": 505.2, "grade": 0.2735144312393891, "Width": 14.199999999999989, "drillhole": "BR-022"}, {"From": 508.75, "To": 512.0, "grade": 0.2735144312393891, "Width": 3.25, "drillhole": "BR-022"}, {"From": 471.0, "To": 478.0, "grade": 2.3699999999999997, "Width": 7.0, "drillhole": "BR-022"}, {"From": 490.0, "To": 491.0, "grade": 8.15, "Width": 1.0, "drillhole": "BR-022"}, {"From": 505.2, "To": 506.2, "grade": 0.8704918032786833, "Width": 1.0, "drillhole": "BR-022"}, {"From": 506.7, "To": 508.75, "grade": 0.8704918032786833, "Width": 2.0500000000000114, "drillhole": "BR-022"}, {"From": 506.2, "To": 506.7, "grade": 100.48, "Width": 0.5, "drillhole": "BR-022"}, {"From": 600.0, "To": 620.0, "grade": 0.52, "Width": 20.0, "drillhole": "BR-022"}]}}, {"mode": "vega-lite"});
</script>
</div>

</div>

</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="nshea3/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/blog/2020/12/02/Mathematics-of-Drilling-Intercepts.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>nshea_techblog</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/nshea3" title="nshea3"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/nicholassh34" title="nicholassh34"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
