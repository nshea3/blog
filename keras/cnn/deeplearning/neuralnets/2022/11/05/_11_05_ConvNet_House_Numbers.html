<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>ConvNet House Numbers | nshea_techblog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="ConvNet House Numbers" />
<meta name="author" content="nshea3" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="nshea_techblog" />
<meta property="og:description" content="nshea_techblog" />
<link rel="canonical" href="https://nshea3.github.io/blog/keras/cnn/deeplearning/neuralnets/2022/11/05/_11_05_ConvNet_House_Numbers.html" />
<meta property="og:url" content="https://nshea3.github.io/blog/keras/cnn/deeplearning/neuralnets/2022/11/05/_11_05_ConvNet_House_Numbers.html" />
<meta property="og:site_name" content="nshea_techblog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-11-05T00:00:00-05:00" />
<script type="application/ld+json">
{"url":"https://nshea3.github.io/blog/keras/cnn/deeplearning/neuralnets/2022/11/05/_11_05_ConvNet_House_Numbers.html","@type":"BlogPosting","headline":"ConvNet House Numbers","dateModified":"2022-11-05T00:00:00-05:00","datePublished":"2022-11-05T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://nshea3.github.io/blog/keras/cnn/deeplearning/neuralnets/2022/11/05/_11_05_ConvNet_House_Numbers.html"},"author":{"@type":"Person","name":"nshea3"},"description":"nshea_techblog","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://nshea3.github.io/blog/feed.xml" title="nshea_techblog" /><!-- the google_analytics_id gets auto inserted from the config file -->



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HNK1VVBKXW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HNK1VVBKXW');
</script>


<link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">nshea_techblog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About Me</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">ConvNet House Numbers</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-11-05T00:00:00-05:00" itemprop="datePublished">
        Nov 5, 2022
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">nshea3</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      6 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#keras">keras</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#cnn">cnn</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#deeplearning">deeplearning</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#neuralnets">neuralnets</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/nshea3/blog/tree/master/_notebooks/2022_11_05_ConvNet_House_Numbers.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/nshea3/blog/master?filepath=_notebooks%2F2022_11_05_ConvNet_House_Numbers.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/nshea3/blog/blob/master/_notebooks/2022_11_05_ConvNet_House_Numbers.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Introduction">Introduction </a></li>
<li class="toc-entry toc-h2"><a href="#The-dataset">The dataset </a></li>
<li class="toc-entry toc-h2"><a href="#Preprocessing">Preprocessing </a></li>
<li class="toc-entry toc-h2"><a href="#Model-Topology">Model Topology </a></li>
<li class="toc-entry toc-h2"><a href="#Parameters-and-Training">Parameters and Training </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022_11_05_ConvNet_House_Numbers.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Introduction">
<a class="anchor" href="#Introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction<a class="anchor-link" href="#Introduction"> </a>
</h2>
<p>I recently encountered a problem at work where we could have made use of georeferenced, exterior images of single-family homes.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/2/2c/Tibbetts-Rumsey_House%2C_Ithaca_NY.jpg" alt=""></p>
<p>Basically like this.</p>
<p>We immediately thought of Google Streetview and Zillow, but unfortunately both of those platforms have very restrictive use policies. We also considered using data from assessors' offices, but that's difficult to do at scale because of the huge variety of ways that these images are stored, to say nothing of the metadata attached to them.</p>
<p>So we set out to find a single source of just <em>images</em>, no licensing or metadata to hold us back. <a href="https://www.mapillary.com/">Mapillary</a> provides an open alternative of entirely crowdsourced photos shared from dashcams. Much better than the alternatives, but it leaves us with a different challenge: 
While we know what street we're on and roughly where we are, we don't know the camera parameters, so we can't precisely associate parts of the image with an address. We don't even have a particularly good idea of which direction the camera is pointed.</p>
<p>The natural solution to this problem is to do what humans did before GPS - look at road signs and house numbers! The address is literally painted all over the structure! We just have to segment it and extract it, ideally in an automated way.</p>
<p>It's difficult to imagine a script that we could explicitly program that would handle all the varying fonts, varying camera angles, varying lighting conditions, varying photo qualities that we'll see in reality. In short, this is a classic use case for deep learning, so we'll assemble and train a quick convolutional neural network here!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-dataset">
<a class="anchor" href="#The-dataset" aria-hidden="true"><span class="octicon octicon-link"></span></a>The dataset<a class="anchor-link" href="#The-dataset"> </a>
</h2>
<p>For this demonstration we'll use the <a href="http://ufldl.stanford.edu/housenumbers/">The Street View House Numbers (SVHN) Dataset</a> from Stanford. This dataset contains a large number of labeled examples that we can use to train a convnet to label individual digits of a street number.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.io</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">layers</span>
<span class="kn">from</span> <span class="nn">tensorflow.python.ops.numpy_ops</span> <span class="kn">import</span> <span class="n">np_config</span>
<span class="n">np_config</span><span class="o">.</span><span class="n">enable_numpy_behavior</span><span class="p">()</span>

<span class="n">mat</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="s1">'/content/drive/MyDrive/DATA/train_32x32.mat'</span><span class="p">)</span>
<span class="n">mat_test</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="s1">'/content/drive/MyDrive/DATA/test_32x32.mat'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is what the 32x32 pixel digits look like:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">imshow</span><span class="p">(</span><span class="n">mat</span><span class="p">[</span><span class="s2">"X"</span><span class="p">][:,:,:,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">imshow</span><span class="p">(</span><span class="n">mat</span><span class="p">[</span><span class="s2">"X"</span><span class="p">][:,:,:,</span><span class="mi">115</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And the associated labels:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">mat</span><span class="p">[</span><span class="s2">"y"</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([3], dtype=uint8)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">mat</span><span class="p">[</span><span class="s2">"y"</span><span class="p">][</span><span class="mi">115</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([3], dtype=uint8)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Even this toy example includes some of the challenges we listed above (varying fonts, varying camera angles, varying lighting conditions, varying photo qualities) - and others that we didn't discuss:</p>
<blockquote>
<p>Character level ground truth in an MNIST-like format. All digits have been resized to a fixed resolution of 32-by-32 pixels. The original character bounding boxes are extended in the appropriate dimension to become square windows, so that resizing them to 32-by-32 pixels does not introduce aspect ratio distortions. Nevertheless this preprocessing introduces some distracting digits to the sides of the digit of interest.</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Preprocessing">
<a class="anchor" href="#Preprocessing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Preprocessing<a class="anchor-link" href="#Preprocessing"> </a>
</h2>
<p>We need to turn our array of RGB images into an array of greyscale images (it's definitely possible to do deep learning with RGB images, but it's a little more involved) And doing a little reshaping as well - need it in batch, pixel_x, pixel_y format.</p>
<p>We're using the</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">x_train</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tensordot</span><span class="p">(</span><span class="n">mat</span><span class="p">[</span><span class="s2">"X"</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.299</span><span class="p">,</span> <span class="mf">0.587</span><span class="p">,</span> <span class="mf">0.114</span><span class="p">],</span> <span class="n">axes</span><span class="o">=</span><span class="p">([</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tensordot</span><span class="p">(</span><span class="n">mat_test</span><span class="p">[</span><span class="s2">"X"</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.299</span><span class="p">,</span> <span class="mf">0.587</span><span class="p">,</span> <span class="mf">0.114</span><span class="p">],</span> <span class="n">axes</span><span class="o">=</span><span class="p">([</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">x_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>TensorShape([73257, 32, 32])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We're using the $v_{gray}(r,g,b) = 0.2989 * r + 0.5870 * g + 0.1140 * b$ formula to convert the (r,g,b) values into a grayscale value.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">imshow</span><span class="p">(</span><span class="n">x_train</span><span class="p">[</span><span class="mi">3</span><span class="p">,:,:])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.image.AxesImage at 0x7f441762d8d0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>New! with zero color!</p>
<p>Now we move on to preparing the labels and further altering the shape of our tensor.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">num_classes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">mat</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]))</span> <span class="o">+</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Num classes: </span><span class="si">{</span><span class="n">num_classes</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">y_train</span> <span class="o">=</span> <span class="n">mat</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">mat_test</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="n">input_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">scale_and_expand</span><span class="p">(</span><span class="n">x_</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">((</span><span class="n">x_</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">"float32"</span><span class="p">)</span> <span class="o">/</span> <span class="mi">255</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>


<span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span> <span class="o">=</span> <span class="p">(</span><span class="n">scale_and_expand</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"x_train shape:"</span><span class="p">,</span> <span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"train samples"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"test samples"</span><span class="p">)</span>

<span class="c1"># convert class vectors to binary class matrices</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Num classes: 11
x_train shape: (73257, 32, 32, 1)
73257 train samples
26032 test samples
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Model-Topology">
<a class="anchor" href="#Model-Topology" aria-hidden="true"><span class="octicon octicon-link"></span></a>Model Topology<a class="anchor-link" href="#Model-Topology"> </a>
</h2>
<p>This is a simple ConvNet architecture (borrowed from <a href="https://keras.io/examples/vision/mnist_convnet/">here</a> in the keras docs, credit to François Chollet)</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s2">"relu"</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s2">"relu"</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_classes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">"softmax"</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 conv2d (Conv2D)             (None, 30, 30, 32)        320       
                                                                 
 max_pooling2d (MaxPooling2D  (None, 15, 15, 32)       0         
 )                                                               
                                                                 
 conv2d_1 (Conv2D)           (None, 13, 13, 64)        18496     
                                                                 
 max_pooling2d_1 (MaxPooling  (None, 6, 6, 64)         0         
 2D)                                                             
                                                                 
 flatten (Flatten)           (None, 2304)              0         
                                                                 
 dropout (Dropout)           (None, 2304)              0         
                                                                 
 dense (Dense)               (None, 11)                25355     
                                                                 
=================================================================
Total params: 44,171
Trainable params: 44,171
Non-trainable params: 0
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Parameters-and-Training">
<a class="anchor" href="#Parameters-and-Training" aria-hidden="true"><span class="octicon octicon-link"></span></a>Parameters and Training<a class="anchor-link" href="#Parameters-and-Training"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="mi">15</span>

<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s2">"categorical_crossentropy"</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s2">"adam"</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">"accuracy"</span><span class="p">])</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span> <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/15
516/516 [==============================] - 101s 195ms/step - loss: 1.5204 - accuracy: 0.5037 - val_loss: 0.7716 - val_accuracy: 0.7935
Epoch 2/15
516/516 [==============================] - 87s 168ms/step - loss: 0.8102 - accuracy: 0.7637 - val_loss: 0.6294 - val_accuracy: 0.8354
Epoch 3/15
516/516 [==============================] - 77s 150ms/step - loss: 0.7143 - accuracy: 0.7977 - val_loss: 0.5900 - val_accuracy: 0.8460
Epoch 4/15
516/516 [==============================] - 89s 173ms/step - loss: 0.6613 - accuracy: 0.8141 - val_loss: 0.5400 - val_accuracy: 0.8598
Epoch 5/15
516/516 [==============================] - 88s 170ms/step - loss: 0.6289 - accuracy: 0.8232 - val_loss: 0.5257 - val_accuracy: 0.8597
Epoch 6/15
516/516 [==============================] - 83s 161ms/step - loss: 0.6051 - accuracy: 0.8284 - val_loss: 0.5008 - val_accuracy: 0.8677
Epoch 7/15
516/516 [==============================] - 80s 155ms/step - loss: 0.5827 - accuracy: 0.8354 - val_loss: 0.4865 - val_accuracy: 0.8657
Epoch 8/15
516/516 [==============================] - 79s 152ms/step - loss: 0.5680 - accuracy: 0.8377 - val_loss: 0.4763 - val_accuracy: 0.8647
Epoch 9/15
516/516 [==============================] - 79s 152ms/step - loss: 0.5498 - accuracy: 0.8421 - val_loss: 0.4652 - val_accuracy: 0.8743
Epoch 10/15
516/516 [==============================] - 78s 151ms/step - loss: 0.5381 - accuracy: 0.8475 - val_loss: 0.4508 - val_accuracy: 0.8721
Epoch 11/15
516/516 [==============================] - 82s 158ms/step - loss: 0.5284 - accuracy: 0.8489 - val_loss: 0.4342 - val_accuracy: 0.8793
Epoch 12/15
516/516 [==============================] - 78s 152ms/step - loss: 0.5147 - accuracy: 0.8515 - val_loss: 0.4243 - val_accuracy: 0.8804
Epoch 13/15
516/516 [==============================] - 78s 151ms/step - loss: 0.5066 - accuracy: 0.8536 - val_loss: 0.4201 - val_accuracy: 0.8795
Epoch 14/15
516/516 [==============================] - 78s 152ms/step - loss: 0.4945 - accuracy: 0.8564 - val_loss: 0.4294 - val_accuracy: 0.8855
Epoch 15/15
516/516 [==============================] - 78s 151ms/step - loss: 0.4897 - accuracy: 0.8574 - val_loss: 0.4050 - val_accuracy: 0.8833
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x7f4416c3fe10&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Looking at the train/validation scores in the diagnostic output, I always have to remind myself that dropout means that validation accuracy will often be <strong>higher</strong> than training accuracy! Otherwise quite happy with the convergence of our model. Let's see how it does on a held-out test set:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">score</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Test loss:"</span><span class="p">,</span> <span class="n">score</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Test accuracy:"</span><span class="p">,</span> <span class="n">score</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Test loss: 0.4587405323982239
Test accuracy: 0.8741933107376099
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Not too bad for a first pass!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sources:</p>
<ul>
<li>
<p><a href="https://stackoverflow.com/questions/43979449/higher-validation-accuracy-than-training-accurracy-using-tensorflow-and-keras">Higher validation accuracy, than training accurracy using Tensorflow and Keras</a></p>
</li>
<li>
<p><a href="https://cs231n.github.io/neural-networks-3/">CS231n Convolutional Neural Networks for Visual Recognition: Lecture 3, Learning</a></p>
</li>
<li>
<p><a href="http://ufldl.stanford.edu/housenumbers/">The Street View House Numbers (SVHN) Dataset</a></p>
</li>
<li>
<p><a href="https://keras.io/examples/vision/mnist_convnet/">Simple MNIST convnet</a></p>
</li>
</ul>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="nshea3/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/blog/keras/cnn/deeplearning/neuralnets/2022/11/05/_11_05_ConvNet_House_Numbers.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>nshea_techblog</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/nshea3" target="_blank" title="nshea3"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/nicholassh34" target="_blank" title="nicholassh34"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
